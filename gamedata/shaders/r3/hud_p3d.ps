#include "common.h"

uniform float4 m_affects;

struct ui_vert_out
{
    float2 tc0 : TEXCOORD0;
};

// https://stackoverflow.com/a/10625698
float random(float2 p)
{
    float2 K1 = float2(23.14069263277926f, // e^pi (Gelfond's constant)
                       2.665144142690225f // 2^sqrt(2) (Gelfondâ€“Schneider constant)
    );
    return frac(cos(dot(p, K1)) * 12345.6789f);
}

float4 main(ui_vert_out I) : SV_Target
{
    float4 r = s_base.Sample(smp_base, I.tc0);

    // Приборы глючат при выбросе
    float mig = 1.0f - (m_affects.x * 2.f);

    return float4(r.r, r.g, r.b, random(timers.xz) > mig ? 0.f : r.a);
}
